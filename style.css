:root {
    --primary-color: #3b82f6;
    --background-color: #111827;
    --surface-color: #1f2937;
    --text-color: #f3f4f6;
    --muted-text-color: #9ca3af;
    --border-color: #374151;
    --danger-color: #ef4444;
    --success-color: #22c55e;
    --card-bg-color: #1f2937;
    --card-text-color: #f3f4f6;
    --card-border-color: #374151;
}

* {
    box-sizing: border-box;
}

html {
    height: 100%;
    height: 100dvh;
    -webkit-font-smoothing: antialiased;
}

body {
    background-color: var(--background-color);
    color: var(--text-color);
    font-family: 'Inter', sans-serif;
    display: flex;
    flex-direction: column;
    height: 100vh;
    height: 100dvh;
    overflow: hidden;
    margin: 0;
    padding: 0;
    position: relative;
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
}

body.fullscreen-active #main-header,
body.fullscreen-active #script-header,
body.fullscreen-active #card-header {
    display: none !important;
}

body.fullscreen-active .main-content {
    height: 100vh;
    height: 100dvh;
}

.page-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 1rem;
    height: 55px;
    background-color: var(--surface-color);
    border-bottom: 1px solid var(--border-color);
    flex-shrink: 0;
    position: relative;
    z-index: 30;
}

.write-mode-header { display: flex; }
.script-mode-header { display: none; }
.card-mode-header { display: none; }

.page-header .header-left,
.page-header .header-right {
    flex: 1;
    display: flex;
    align-items: center; /* Vertically align items in header */
}

/* MODIFIED: Reduced gap between header buttons */
.page-header .header-right {
    justify-content: flex-end;
    gap: 8px; /* This controls the space between buttons like '+' and 'Save' */
}

.page-header .header-center {
    flex: 2;
    display: flex;
    justify-content: center;
}

.icon-btn {
    background: none;
    border: none;
    color: var(--muted-text-color);
    font-size: 1.5rem;
    cursor: pointer;
    padding: 0.5rem;
    border-radius: 50%;
    line-height: 1;
    touch-action: manipulation;
    min-width: 44px;
    min-height: 44px;
}

.icon-btn:hover,
.icon-btn:active {
    background-color: var(--background-color);
    color: white;
}

/* (The rest of the non-card related CSS remains the same as your original file) */
/* ... */

#card-view {
    overflow-y: auto; /* This enables the main scrollbar on the right */
    width: 100%;
}

#card-container {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(420px, 1fr));
    gap: 25px;
    padding: 20px;
    padding-right: 60px;
    justify-items: start;
    max-width: 1800px;
    margin: 0;
}

.scene-card {
    background-color: var(--card-bg-color) !important;
    color: var(--card-text-color) !important;
    border: 1px solid var(--card-border-color) !important;
    border-radius: 12px;
    padding: 12px; /* MODIFIED: Reduced card's internal frame size */
    display: flex;
    position: relative;
    cursor: grab;
    transition: all 0.3s ease;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
    width: 100%;
    max-width: 450px;
    min-height: initial; /* Allows card to shrink-wrap content */
    height: auto;
    font-family: 'Courier New', 'Courier Prime', monospace;
    font-size: 13px; /* MODIFIED: Base text size is now 13px */
    line-height: 1.5; /* MODIFIED: Adjusted for new font size */
    box-sizing: border-box;
    overflow: visible;
}

.scene-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.6);
    border-color: var(--primary-color);
}

.scene-card.dragging {
    opacity: 0.8;
    transform: rotate(3deg) scale(1.02);
    z-index: 1000;
}

.card-actions {
    position: absolute;
    right: -50px;
    top: 50%;
    transform: translateY(-50%);
    z-index: 10;
    opacity: 0;
    transition: all 0.3s ease;
}

.scene-card:hover .card-actions {
    opacity: 1;
    right: -45px;
}

.card-actions .icon-btn {
    width: 36px;
    height: 36px;
    border-radius: 8px;
    border: 1px solid var(--border-color);
    background: rgba(55, 65, 81, 0.8);
    color: var(--muted-text-color);
    font-size: 16px;
    cursor: pointer;
    backdrop-filter: blur(4px);
    -webkit-backdrop-filter: blur(4px);
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: center;
}

.card-actions .icon-btn:hover {
    background: rgba(75, 85, 99, 1);
    color: var(--text-color);
    transform: scale(1.1);
    box-shadow: none;
}

.scene-card-content {
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    box-sizing: border-box;
}

.card-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 10px;
    padding-bottom: 8px;
    border-bottom: 1px solid var(--card-border-color);
    min-height: 32px;
    flex-shrink: 0;
}

.card-scene-title {
    flex-grow: 1;
    font-weight: bold;
    text-transform: uppercase;
    font-family: 'Courier New', 'Courier Prime', monospace;
    font-size: 13px; /* This is the scene heading size */
    line-height: 1.3;
    padding: 4px 6px;
    border: 1px solid transparent;
    border-radius: 4px;
    outline: none;
    background: transparent;
    margin-right: 12px;
    min-height: 20px;
    color: var(--card-text-color) !important;
}

.card-scene-title:focus {
    border-color: var(--primary-color);
    background-color: rgba(59, 130, 246, 0.1);
    box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);
}

.card-scene-title[contenteditable="true"]:empty:before {
    content: attr(data-placeholder);
    color: var(--muted-text-color);
    font-style: italic;
}

.card-scene-number {
    font-family: 'Courier New', 'Courier Prime', monospace;
    font-size: 12px;
    font-weight: bold;
    color: var(--muted-text-color) !important;
    background: rgba(55, 65, 81, 0.8) !important;
    border: 1px solid var(--card-border-color) !important;
    border-radius: 6px;
    padding: 4px 6px;
    width: 54px;
    max-width: 54px;
    text-align: center;
    outline: none;
    flex-shrink: 0;
}

.card-scene-number:focus {
    border-color: var(--primary-color) !important;
    background-color: rgba(59, 130, 246, 0.2) !important;
    color: var(--text-color) !important;
    box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);
}

.card-body {
    display: flex;
    flex-direction: column;
    height: auto;
}

.card-description {
    width: 100%;
    border: 1px solid var(--card-border-color) !important;
    border-radius: 8px;
    padding: 10px;
    font-family: 'Courier New', 'Courier Prime', monospace;
    /* Font size is inherited from .scene-card, so it's now 13px */
    line-height: 1.5;
    resize: none;
    outline: none;
    background: rgba(17, 24, 39, 0.8) !important;
    color: var(--card-text-color) !important;
    box-sizing: border-box;
    overflow-y: hidden;
    min-height: 120px;
    height: auto;
}

.card-description:focus {
    border-color: var(--primary-color) !important;
    background-color: rgba(17, 24, 39, 0.9) !important;
    box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);
}

.card-description::placeholder {
    color: var(--muted-text-color) !important;
    font-style: italic;
    font-family: 'Courier New', 'Courier Prime', monospace;
}

.card-watermark {
    position: absolute;
    bottom: 8px;
    left: 12px;
    font-size: 8px;
    color: rgba(156, 163, 175, 0.3) !important;
    opacity: 0.5;
    font-family: 'Inter', sans-serif;
    font-weight: 400;
    pointer-events: none;
    z-index: 1;
}

/* (The rest of your CSS file, including the full mobile media query, modal styles, print styles, and scrollbar styles, would continue from here exactly as it was in the last complete version I provided.) */
